[Задача по автотесту с ЧПУ](https://tracker.yandex.ru/AVTOMATIZACIYA-38)

#Блок1#

1. **Сценарий: 01.** Заполнение ИБ.

Создаются: Клиент, услуга(Персональная и групповая), Пробный пакет услуг, помещение.

2. **Сценарий: 02.** Проверка созданных данных.


3. **Сценарий: 03.** Блок 1: Проверка кол-ва доступных продаж пробного пакета на одно лицо.

Открывается карточка клиента и запоминается в переменную статус клиента. Создается продажа пробного пакета этому клиенту, после продажи в настройках посещений выставляется настройка через сколько дней клиент становится бывшим, выставляется "1" и запускается регламентное задание для установки статуса. После выполнения регламента перезаходится в карточку клиента и проверяется текущий статус клиента. И создается также вторая продажа пробного пакета, чтобы проверить позволит ли клиенту купить второй.

4. **Сценарий: 04.** Блок 1: Проверка добавлена услуг/смена номенклатуры, ограничение по кол-ву использований в "N" дней.

Создается членство, модификатор добавления услуг и продажа этого членства. Через регистр проверяется кол-во услуг в членстве после продажи. Потом в проданное членство добавляются услуги через модификатор и также проверяется их кол-во через регистр. И создается занятие с проверкой основания.

5. **Сценарий: 05.** Блок 1: Проверка заморозок.
Заходится в карточку сотрудника(Админ) и ему в настройках прав и доступа убираются права на заморозку и активацию задним числом. Создается новый клиент и продается ему членство. Проданному членству добавляются фиксированные дни заморозки и через регистр проверяется их наличие.

Проданному членству меняется дата активации на задние число, затем проверяется на какое кол-во дней можно заморозить членство, потом проверяется доступна ли заморозка задним числом.

После проверки возвращаем Админу права для заморозки и активации задним числом. Затем проверяется через регистр списались ли дни заморозки после того, как мы сделали заморозки задним числом.

Потом развораживаем членство и проверяем по регистру добавление дополнительных дней срока действия.

6. **Сценарий: 06.** Блок 1: Проверка гостевых посещений.

Создается новый клиент и гость, ему продается членство, и создается модификатор для добавления гостевых визитов. После создания оформляется продажа членства и в ней добавляется фиксированное кол-во гостевых визитов с помощью модификатора.

Затем с рецепции делается вход для гостя и проверяется создалось ли посещение и списалось ли гостевое посещение по регистру.

7. **Сценарий: 07.** Блок 1: Проверка рассчета сумм при продаже членства.

Создается новый клиент и ему продажа членства. После продажи переходится в карточку проданного ЧПУ в раздел "История списания". С этого раздела из таблица по колонке "Сумма" считываются значения в массив. Потом через код встроенного языка записывается в переменную через ";" записывается массив с 3 до его границы. И дальше уже идет расчет сумм пока не дойдет до нуля.

8. **Сценарий: 08.** Блок 1: Проверка разных типов активации ЧПУ.

Тут думаю и так понятно что будет проверяться возможность активации членств с разными настройками.

9. **Сценарий: 09.** Блок 1: Проверка тумблера "При наличие действующего членства".

//Пока не работает как будто или же не предусмотрено выставлять дату активации будущим числом.

10. **Сценарий: 10.** Возврат настроек.

Пользователю убирается возможность замороживать задним числом и меньшим сроком.

#Блок2#

1. **Сценарий: 1.** Заполнение ИБ.

Создаю клиента, услугу персональную и групповую, членство и помещение.

2. **Сценарий: 2.** Блок 2: Проверка ограничения "Ограничено временем".

В членстве включается соответствующая настройка, создается продажа этого членства. Заходится на рецепции и проверяется есть ли возможность использовать членство в текущие время и можно ли по нему войти. Также в занятие происходит проверка подставления основания.

3. **Сценарий: 3.** Блок 2: Проверка ограничения "Ограничено частотой".

Пересоздается клиент. В членстве выставляется соответвующая настройка и продается клиенту. Потом создается посещение клиенту и пытаюсь потом оформить вход с рецепции чтобы клиент попал под ограничение. И проверяется по регистру списания.

4. **Сценарий: 4.** Блок 2: Проверка ограничения "Ограничено посещениями".

Пересоздается клиент. В членстве выставляется соответвующая настройка и продается клиенту. Потом создается посещение клиенту и пытаюсь потом оформить вход с рецепции чтобы клиент попал под ограничение. И проверяется по регистру списания.

5. **Сценарий: 5.** Блок 2: Проверка ограничения дополнительного владельца ЧПУ.

В настройках рецепции выставляется насройка чтобы при входе не очищалась рецепция. Пересоздается клиент и создается второй. В настройках членства выставляется кол-во доп.владельцев и создается продажа членства.

6. **Сценарий: 6.** Возврат настроек рецепции.

На рецепции убирается настройка с автоматической регистрацией.
